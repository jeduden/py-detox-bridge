language: objective-c
osx_image: xcode8.3
sudo: required
cache:
  directories:
    - /Library/Caches/Homebrew
    - /usr/local/Cellar
before_install:
  - curl https://www.python.org/ftp/python/3.6.1/python-3.6.1-macosx10.6.pkg > /tmp/python3.6.1.pkg && sudo installer -pkg /tmp/python3.6.1.pkg -target /
  - curl https://www.python.org/ftp/python/3.5.3/python-3.5.3-macosx10.6.pkg > /tmp/python3.5.3.pkg && sudo installer -pkg /tmp/python3.5.3.pkg -target /
  - pip install codecov
  - export CODE_SIGNING_REQUIRED=NO
  - which fbsimctl || brew tap facebook/fb && brew install fbsimctl --HEAD
  - export NVM_DIR="$HOME/.nvm" && [ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh"
  - nvm install 7.6.0
install:
  - nvm use
script:
  - make build
  - make example_app
after_success:
  - codecov
deploy:
  provider: pypi
  user: kpn-digital
  skip_cleanup: true
  password:
    secure: ...travis encrypt --add deploy.password...
  on:
    tags: true
    all_branches: true
